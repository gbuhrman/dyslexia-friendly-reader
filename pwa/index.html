<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 'self';
  style-src 'self';
  img-src 'self' data: blob:;
  font-src 'self' data:;
  connect-src 'self' https://api.dictionaryapi.dev;
  worker-src 'self' blob:;
  frame-src 'none';
  child-src 'none';
  base-uri 'none';
  form-action 'none';
  manifest-src 'self';
">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dyslexia-Friendly Reader (Bookmark Fix + Holistic Speech)</title>

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="reader.css">

  <!-- JSZip must load before epub.js -->
  <script src="vendor/jszip/jszip.min.js" defer></script>
  <script src="reader.js" defer></script>

  <link rel="apple-touch-icon" sizes="192x192" href="./icons/icon-192x192.png">
  <link rel="apple-touch-icon" sizes="256x256" href="./icons/icon-256x256.png">
  <link rel="apple-touch-icon" sizes="384x384" href="./icons/icon-384x384.png">
  <link rel="apple-touch-icon" sizes="512x512" href="./icons/icon-512x512.png">
</head>
<body>
  <div id="controls">
    <label>Font: 
      <select id="fontSelect">
        <option value="OpenDyslexic, Arial, sans-serif">OpenDyslexic</option>
        <option value="Arial, sans-serif">Arial</option>
        <option value="Verdana, sans-serif">Verdana</option>
      </select>
    </label>
    <label>Size: <input type="range" id="fontSize" min="14" max="28" value="18"></label>
    <label>Line Spacing: <input type="range" id="lineSpacing" min="1" max="2.5" step="0.1" value="1.6"></label>
    <label>Text Color: <input type="color" id="textColor" value="#000000"></label>
    <label>Background: <input type="color" id="bgColor" value="#f8f8f8"></label>

    <!-- Accept EPUBs now -->
    <label>Upload: <input type="file" id="fileInput" accept=".txt,.epub,application/epub+zip"></label>

    <label><input type="checkbox" id="autoformatToggle" checked> Autoformat readability</label>
    <label><input type="checkbox" id="clickReadToggle"> Click-to-Read Mode</label>
    <label>Reading Speed: <input type="range" id="speedControl" min="0.5" max="2.5" step="0.1" value="1"></label>
    <label>Voice: 
      <select id="voiceSelect" aria-label="Voice selection">
        <option value="">Loading voicesâ€¦</option>
      </select>
    </label>
    <button id="toggleReadingBtn" type="button" aria-pressed="false" title="Toggle Reading Mode">Reading Mode</button>
    <button id="readAloudBtn">Read Aloud from Beginning</button>
    <button id="stopReadAloudBtn">Stop</button>
    <label>Chapter: <select id="chapterSelect"><option value="">--Select--</option></select></label>
    <button id="bookmarkBtn">Bookmark</button>
    <button id="gotoBookmarkBtn">Go to Bookmark</button>
  </div>

  <div id="content" role="main" aria-live="polite">
    <h1>Dyslexia-Friendly Reader</h1>
    <h2>Installation Instructions and Feature Explanations</h2>
    <div id="story">
      Desktop App Install: In Chrome browser window double click Install button. 
      iPhone App Install: Open in Safari. Click the Share button. Scroll down and select Add to Home Screen.
      Personalize your reading experience by adjusting font type, font size, line spacing, background color and text color.
      Click to Read: Speech engine will read out loud with the selected voice and reading speed wherever you click.
      Autoformat for Readability: Automatically reformat your text by splitting up long paragraphs and separating dialogue.
      Reading mode: Minimizes Selection screen to a small icon in the bottom right hand corner.
      Use the following sample text passage to personalize your settings, then Upload any text file to read.
      Read Aloud and Autoformat features only work with uploaded text files.
      For more information, to leave a comment, or find a good book to read next,
      visit us at howardforgepress.com
      Enjoy!

      Howard Castle dominated the landscape. The high central dome pierced the clouds. The halls were lined with large windows designed to let in excess sunlight, illuminating the numerous paintings and tapestries that lined the walls. The grounds surrounding the Castle were perfectly manicured. The long, well-groomed lawns ensured visitors would have a long, uninterrupted view of the Castle as they made their way to the entrance, and that was the point. The Right Honorable Charles Howard, 3rd Earl of Carlisle, who had died 8 years ago in May, built to impress. The Castle was more than a home; it was a masterpiece of architectural ambition that was the outward manifestation of his political ambition. In his prime, Lord Charles Howard rose to the highest of political offices, acting for a time as the Lord Justice of the Realm, holding England together for a short time between the reigns of Queen Anne and King George I. In his time, Howard Castle played host to monarchs, generals, and the other Lords of the land. Many came to Howard Castle seeking political favors and alliances, and the long walk to Howard Castle ensured they arrived dutifully impressed with the power and privilege that resided there.
      Designed by Sir John Vanbrugh, its baroque splendor was unmatched. The estate contained vast gardens with classical statues, cascading fountains, and hedges stretching toward the River Derwent. It was a world of refinement and excess, where every corner whispered of the family's legacy, a legacy that William Howard, the grandson of Lord Charles, would one day squander.
    </div>
    <div id="definitionPopup" role="status" aria-live="polite"></div>
  </div>

  <button id="quickControlsBtn" class="fab" type="button" hidden aria-label="Show controls">Aa</button>
  <footer>Powered by Howard Forge Press</footer>
</body>
</html>
