<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dyslexia-Friendly Reader (Bookmark Fix + Holistic Speech)</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="reader.css">
  <script src="vendor/epub/epub.min.js" defer></script>
  <script src="reader.js" defer></script>
</head>
<body>
  <div id="controls">
    <label>Font: 
      <select id="fontSelect">
        <option value="OpenDyslexic, Arial, sans-serif">OpenDyslexic</option>
        <option value="Arial, sans-serif">Arial</option>
        <option value="Verdana, sans-serif">Verdana</option>
      </select>
    </label>
    <label>Size: <input type="range" id="fontSize" min="14" max="28" value="18"></label>
    <label>Line Spacing: <input type="range" id="lineSpacing" min="1" max="2.5" step="0.1" value="1.6"></label>
    <label>Text Color: <input type="color" id="textColor" value="#000000"></label>
    <label>Background: <input type="color" id="bgColor" value="#f8f8f8"></label>
    <label>Upload: <input type="file" id="fileInput" accept=".txt"></label>
    <label><input type="checkbox" id="autoformatToggle" checked> Autoformat readability</label>
    <label><input type="checkbox" id="clickReadToggle"> Click-to-Read Mode</label>
    <label>Reading Speed: <input type="range" id="speedControl" min="0.5" max="2.5" step="0.1" value="1"></label>
    <label>Voice: 
      <select id="voiceSelect" aria-label="Voice selection">
        <option value="">Loading voicesâ€¦</option>
      </select>
    </label>
    <button id="toggleReadingBtn" type="button" aria-pressed="false" title="Toggle Reading Mode">Reading Mode</button>
    <button id="readAloudBtn">Read Aloud from Beginning</button>
    <button id="stopReadAloudBtn">Stop</button>
    <label>Chapter: <select id="chapterSelect"><option value="">--Select--</option></select></label>
    <button id="bookmarkBtn">Bookmark</button>
    <button id="gotoBookmarkBtn">Go to Bookmark</button>
  </div>

  <div id="content" role="main" aria-live="polite">

    <h1>Dyslexia-Friendly Reader</h1>
<section id="epubPanel" hidden aria-label="EPUB Reader">
  <div class="epub-controls">
    <button id="epubPrevBtn" aria-label="Previous page">Prev</button>
    <button id="epubNextBtn" aria-label="Next page">Next</button>
    <label>EPUB Font Size: <input type="range" id="epubFontSize" min="80" max="180" step="10" value="100"></label>
    <button id="epubSpeakBtn">Speak current page</button>
    <button id="epubCloseBtn">Close EPUB</button>
  </div>
  <div id="epub-viewer" style="width:100%;height:70vh;border:1px solid #ddd;border-radius:10px;background:#fff;"></div>
</section>
    <h2>Upload Your Own Text to use Read Aloud Features</h2>
    <div id="story">
      Howard Castle dominated the landscape. The high central dome pierced the clouds. The halls were lined with large windows designed to let in excess sunlight, illuminating the numerous paintings and tapestries that lined the walls. The grounds surrounding the Castle were perfectly manicured. The long, well-groomed lawns ensured visitors would have a long, uninterrupted view of the Castle as they made their way to the entrance, and that was the point. The Right Honorable Charles Howard, 3rd Earl of Carlisle, who had died 8 years ago in May, built to impress. The Castle was more than a home; it was a masterpiece of architectural ambition that was the outward manifestation of his political ambition. In his prime, Lord Charles Howard rose to the highest of political offices, acting for a time as the Lord Justice of the Realm, holding England together for a short time between the reigns of Queen Anne and King George I. In his time, Howard Castle played host to monarchs, generals, and the other Lords of the land. Many came to Howard Castle seeking political favors and alliances, and the long walk to Howard Castle ensured they arrived dutifully impressed with the power and privilege that resided there.
      Designed by Sir John Vanbrugh, its baroque splendor was unmatched. The estate contained vast gardens with classical statues, cascading fountains, and hedges stretching toward the River Derwent. It was a world of refinement and excess, where every corner whispered of the family's legacy, a legacy that William Howard, the grandson of Lord Charles, would one day squander.
    </div>
    <div id="definitionPopup" role="status" aria-live="polite"></div>
    
<section id="libraryPanel" aria-label="Library and OPDS" style="margin-top:1rem;">
  <h2>Library</h2>
  <div class="lib-controls" style="display:flex;gap:.5rem;flex-wrap:wrap;margin:.5rem 0;">
    <input id="libSearch" type="search" placeholder="Search title or author" aria-label="Search">
    <select id="libGenreFilter" aria-label="Filter by genre">
      <option value="">All genres</option>
    </select>
    <select id="libSort" aria-label="Sort by">
      <option value="title">Sort: Title</option>
      <option value="author">Sort: Author</option>
      <option value="fk">Sort: FK Grade</option>
      <option value="df">Sort: DF Score</option>
    </select>
    <button id="libRefreshBtn" type="button">Refresh</button>
  </div>

  <div class="opds-controls" style="display:flex;gap:.5rem;flex-wrap:wrap;margin:.5rem 0;">
    <select id="opdsSourceSelect" aria-label="OPDS source">
      <option value="./opds/index.json" selected>Local OPDS (bundled)</option>
    </select>
    <input id="opdsCustomUrl" type="url" placeholder="https://example.com/opds/index.json" aria-label="Custom OPDS URL" style="min-width:20rem;">
    <button id="opdsLoadBtn" type="button">Load OPDS</button>
  </div>

  <div id="libStatus" style="margin:.25rem 0;"></div>
  <ul id="libList" style="list-style:none;padding:0;margin:0;display:grid;gap:.5rem;"></ul>
</section>

  </div>

  <footer>Powered by Howard Forge Press</footer>
<button id="quickControlsBtn" class="fab" type="button" hidden aria-label="Show controls">Aa</button>
</body>
</html>
